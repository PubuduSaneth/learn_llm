

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction to tokenization &mdash; Learn LLMs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_lesson.css?v=e9df6548" />
      <link rel="stylesheet" type="text/css" href="../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=187304be"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=35a8b989"></script>
      <script src="../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=1ae7504c"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Introduction to embedding" href="../04.Embeddings/" />
    <link rel="prev" title="GPT - Generative Pretrained Transformer model" href="../02.GPT_intro/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Learn LLMs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The lesson</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01.LLM_intro/">Introduction to Large Language Models (LLMs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.GPT_intro/">GPT - Generative Pretrained Transformer model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction to tokenization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tokenizers">Tokenizers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#text-to-sub-word-units">Text to sub-word units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tokenization-step-by-step">Tokenization step-by-step</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gpt-2-tokenizer">GPT-2 tokenizer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#text-to-token-ids">Text to Token-IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#text-to-subword-units">Text to subword units</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04.Embeddings/">Introduction to embedding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.Transformer_block/">Transformer blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06.Attention_mechanism/">Self-attention mechanism</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick-reference/">Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Learn LLMs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Introduction to tokenization</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/coderefinery/content/blob/main/content/03.tokenizer.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-tokenization">
<h1>Introduction to tokenization<a class="headerlink" href="#introduction-to-tokenization" title="Link to this heading"></a></h1>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<p><strong>Understand:</strong></p>
<ul class="simple">
<li><p>What is tokenization?</p></li>
<li><p>Why it is important?</p></li>
<li><p>How tokenizer process input test</p></li>
</ul>
</div>
<section id="tokenizers">
<h2>Tokenizers<a class="headerlink" href="#tokenizers" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>What is tokenization?</p>
<ul>
<li><p>Tokenizers take text as input and generate a sequence of integer representations of input text</p></li>
</ul>
</li>
<li><p>Why it is important?</p>
<ul>
<li><p>This serves as the foundation for converting text to numerical representations that deep learning models can process</p></li>
</ul>
</li>
</ul>
<section id="text-to-sub-word-units">
<h3>Text to sub-word units<a class="headerlink" href="#text-to-sub-word-units" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Tokenizers process these input text by converting them into discrete sub-word units</p>
<ul>
<li><p>i.e, Split input test in to discrete sub-word units</p></li>
</ul>
</li>
<li><p>These “discrete  sub-word units” are tokens</p></li>
<li><p>Token are mapped to corresponding Token IDs using the model vocabulary</p></li>
</ul>
</section>
<section id="tokenization-step-by-step">
<h3>Tokenization step-by-step<a class="headerlink" href="#tokenization-step-by-step" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Tokenizer accepts text <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">sat</span> <span class="pre">on</span> <span class="pre">the</span></code> as input</p></li>
<li><p>Split test into words: <code class="docutils literal notranslate"><span class="pre">cat</span></code>, <code class="docutils literal notranslate"><span class="pre">sat</span></code>, <code class="docutils literal notranslate"><span class="pre">on</span></code>, <code class="docutils literal notranslate"><span class="pre">the</span></code></p>
<ol class="arabic simple">
<li><p>Tokenizer split text into sub-words. In this case, sub-words from the tokenizer are equal to words in the text</p></li>
</ol>
</li>
<li><p>Tokenizer uses model’s vocabulary as a lookup table to map tokens to integer IDs</p>
<ol class="arabic simple">
<li><p>Vocabulary: A dictionary of unique tokens and unique numerical identifiers assigned to each token (Token ID)</p></li>
<li><p>This provides a consistent mapping system that converts variable-length text into fixed numerical representations</p></li>
</ol>
</li>
<li><p>Return corresponding token-IDs of the tokens from input text</p></li>
</ol>
<p>Vocabulary is build from training data by mapping each unique token to a token ID, with special tokens added to handle unknown words and document boundaries, enabling LLMs to process diverse text inputs effectively. The vocabulary size is managed to balance expressiveness with computational efficiency</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/Tokenizers.png"><img alt="Word Tokenization" src="../_images/Tokenizers.png" style="width: 403.2px; height: 578.9px;" />
</a>
</figure>
</section>
</section>
<section id="gpt-2-tokenizer">
<h2>GPT-2 tokenizer<a class="headerlink" href="#gpt-2-tokenizer" title="Link to this heading"></a></h2>
<section id="text-to-token-ids">
<h3>Text to Token-IDs<a class="headerlink" href="#text-to-token-ids" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoTokenizer</span>

<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;gpt2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length of the vocabulary: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">sentence</span> <span class="o">=</span> <span class="s2">&quot;cat sat on the&quot;</span>
<span class="n">token_ids</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Token IDs of the sentence &#39;</span><span class="si">{</span><span class="n">sentence</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">token_ids</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">decoded_sentence</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decoded sentence: </span><span class="si">{</span><span class="n">decoded_sentence</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="text-to-subword-units">
<h3>Text to subword units<a class="headerlink" href="#text-to-subword-units" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">summarization_token_ids</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;summarization&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Token IDs for word `summarization`:&quot;</span><span class="p">,</span> <span class="n">summarization_token_ids</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mapping of tokens to token IDs:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">token_id</span> <span class="ow">in</span> <span class="n">summarization_token_ids</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token_id</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39; -&gt; </span><span class="si">{</span><span class="n">token_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

</pre></div>
</div>
<div class="admonition-output instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Output</p>
<details>
<summary>Text to Token-IDs</summary>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Length of the vocabulary: 50257
Token IDs of the sentence &#39;cat sat on the&#39;: [9246, 3332, 319, 262]
Decoded sentence: cat sat on the
</pre></div>
</div>
</details>
<details>
<summary>Text to subword units</summary>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Token IDs for word `summarization`: [16345, 3876, 1634]

Mapping of tokens to token IDs:
&#39;sum&#39; -&gt; 16345
&#39;mar&#39; -&gt; 3876
&#39;ization&#39; -&gt; 1634

</pre></div>
</div>
</details>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../02.GPT_intro/" class="btn btn-neutral float-left" title="GPT - Generative Pretrained Transformer model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../04.Embeddings/" class="btn btn-neutral float-right" title="Introduction to embedding" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Pubudu Samarakoon.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>